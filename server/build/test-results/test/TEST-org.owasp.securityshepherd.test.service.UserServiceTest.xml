<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="UserService unit test" tests="65" skipped="0" failures="0" errors="0" timestamp="2020-09-14T14:07:38" hostname="PCSE07195" time="17.345">
  <properties/>
  <testcase name="findPasswordAuthByUserId_NoPasswordAuthExists_ReturnsEmpty()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="1.057"/>
  <testcase name="setClassId_NonExistentClassId_ReturnsClassIdNotFoundException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.019"/>
  <testcase name="setDisplayName_NullDisplayName_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="findPasswordAuthByLoginName_EmptyLoginName_ReturnsIllegalArgumentException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="createPasswordUser_DuplicateDisplayName_ReturnsDuplicateUserDisplayNameException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.008"/>
  <testcase name="createPasswordUser_ValidData_Succeeds()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.025"/>
  <testcase name="demote_UserIsAdmin_Demoted()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.317"/>
  <testcase name="authenticate_InvalidUsername_ReturnsFalse()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="findById_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.004"/>
  <testcase name="setClassId_ValidClassId_Succeeds()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.008"/>
  <testcase name="setDisplayName_UserIdDoesNotExist_ReturnsUserIdNotFoundException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.006"/>
  <testcase name="findDisplayNameById_InvalidUserId_ReturnsInvalidUserIdExceptio()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.004"/>
  <testcase name="findAll_NoUsersExist_ReturnsEmpty()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="getKeyById_KeyExists_ReturnsKey()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.112"/>
  <testcase name="findPasswordAuthByLoginName_NonExistentLoginName_ReturnsEmpty()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="create_NullArgument_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="setClassId_InvalidClassId_ReturnsInvalidClassIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.005"/>
  <testcase name="promote_UserIsAdmin_StaysAdmin()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.008"/>
  <testcase name="createPasswordUser_EmptyPasswordHash_ReturnsIllegalArgumentException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="findUserAuthByUserId_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.004"/>
  <testcase name="findById_NonExistentUserId_ReturnsEmpty()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.006"/>
  <testcase name="findByLoginName_UserExists_ReturnsUser()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.136"/>
  <testcase name="findByLoginName_EmptyLoginName_ReturnsIllegalArgumentException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.005"/>
  <testcase name="findDisplayNameById_UserExists_ReturnsDisplayName()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.009"/>
  <testcase name="authenticate_EmptyUsername_ReturnsIllegalArgumentException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="findPasswordAuthByLoginName_NullLoginName_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="findUserAuthByUserId_NonExistentUserId_ReturnsEmpty()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.005"/>
  <testcase name="getKeyById_NoKeyExists_GeneratesKey()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.005"/>
  <testcase name="findByLoginName_LoginNameDoesNotExist_ReturnsEmptyMono()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.001"/>
  <testcase name="authenticate_NullUsername_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.001"/>
  <testcase name="promote_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.004"/>
  <testcase name="findUserAuthByUserId_ExistingUserId_ReturnsUserAuth()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="findPasswordAuthByLoginName_ExistingLoginName_ReturnsPasswordAuth()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.001"/>
  <testcase name="createPasswordUser_EmptyLoginName_ReturnsIllegalArgumentException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.001"/>
  <testcase name="create() must return exception if display name already exists" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.007"/>
  <testcase name="getAuthoritiesByUserId_UserIsAdmin_ReturnsAdminAuthority()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.009"/>
  <testcase name="getKeyById_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="findPasswordAuthByUserId_PasswordAuthExists_ReturnsPasswordAuth()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.009"/>
  <testcase name="findPasswordAuthByUserId_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.004"/>
  <testcase name="findAll_UsersExist_ReturnsUsers()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.011"/>
  <testcase name="setClassId_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="setDisplayName_ValidArguments_DisplayNameIsSet()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.012"/>
  <testcase name="createPasswordUser_NullPasswordHash_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="createPasswordUser_EmptyDisplayName_ReturnsIllegalArgumentException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="findDisplayNameById_NoUserExists_ReturnsEmpty()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="getAuthoritiesByUserId_UserIsNotAdmin_ReturnsUserAuthority()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="demote_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="setDisplayName_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.007"/>
  <testcase name="authenticate_NullPassword_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.02"/>
  <testcase name="createPasswordUser_DuplicateLoginName_ReturnsDuplicateClassNameException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.004"/>
  <testcase name="create() must return exception if display name already exists" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.005"/>
  <testcase name="create_ValidDisplayName_CreatesUser()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.016"/>
  <testcase name="createPasswordUser_NullDisplayName_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.024"/>
  <testcase name="createPasswordUser_NullLoginName_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.001"/>
  <testcase name="deleteById_ValidUserId_CallsRepository()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.008"/>
  <testcase name="findByLoginName_NullLoginName_ReturnsNullPointerException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.001"/>
  <testcase name="count() should call repository and return user count" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.002"/>
  <testcase name="setDisplayName_EmptyDisplayName_ReturnsIllegalArgumentException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.001"/>
  <testcase name="deleteById_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="findById_ExistingUserId_ReturnsUserEntity()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="getAuthoritiesByUserId_InvalidUserId_ReturnsInvalidUserIdException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.003"/>
  <testcase name="authenticate_EmptyPassword_ReturnsIllegalArgumentException()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.001"/>
  <testcase name="demote_UserIsNotAdmin_StaysNotAdmin()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="0.011"/>
  <testcase name="authenticate_ValidUsernameButInvalidPassword_ReturnsTrue()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="14.589"/>
  <testcase name="authenticate_ValidUsernameAndPassword_ReturnsTrue()" classname="org.owasp.securityshepherd.test.service.UserServiceTest" time="13.137"/>
  <system-out><![CDATA[16:07:38.997 [ForkJoinPool-1-worker-1] DEBUG reactor.core.publisher.Hooks - Enabling stacktrace debugging via onOperatorDebug
16:07:40.125 [ForkJoinPool-1-worker-1] INFO org.owasp.securityshepherd.user.UserService - Creating new password login user with display name createPasswordUser_DuplicateDisplayName and login name _createPasswordUser_DuplicateDisplayName_
16:07:40.136 [ForkJoinPool-1-worker-1] INFO org.owasp.securityshepherd.user.UserService - Creating new password login user with display name createPasswordUser_ValidData and login name _createPasswordUser_ValidData_
16:07:40.272 [ForkJoinPool-1-worker-4] INFO org.owasp.securityshepherd.service.ConfigurationService - Refreshing server key
16:07:40.494 [ForkJoinPool-1-worker-1] INFO org.owasp.securityshepherd.user.UserService - Setting display name of user id 550 to newName
16:07:40.632 [ForkJoinPool-1-worker-7] INFO org.owasp.securityshepherd.module.sqlinjection.SqlInjectionTutorial - Creating sql tutorial module
16:07:40.640 [ForkJoinPool-1-worker-1] INFO org.owasp.securityshepherd.user.UserService - Promoting user with id 899 to admin
16:07:40.937 [ForkJoinPool-1-worker-4] INFO org.owasp.securityshepherd.service.ConfigurationService - Refreshing server key
16:07:40.941 [ForkJoinPool-1-worker-4] DEBUG org.owasp.securityshepherd.service.ConfigurationService - Setting configuration key serverKey to value ign53RGMogDgi0GBDFIJHQ==
16:07:43.177 [ForkJoinPool-1-worker-0] INFO org.owasp.securityshepherd.user.UserService - Setting display name of user id 652 to newDisplayName
16:07:43.196 [ForkJoinPool-1-worker-0] INFO org.owasp.securityshepherd.user.UserService - Creating new password login user with display name createPasswordUser_DuplicateLoginName and login name _createPasswordUser_DuplicateLoginName_
16:07:43.201 [ForkJoinPool-1-worker-3] INFO org.owasp.securityshepherd.user.UserService - Creating new user with display name TestUser
16:07:43.202 [ForkJoinPool-1-worker-0] INFO org.owasp.securityshepherd.user.UserService - Creating new user with display name createPasswordUser_DuplicateDisplayName
16:07:43.212 [ForkJoinPool-1-worker-3] INFO org.owasp.securityshepherd.user.UserService - Demoting user with id 933 to user
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
